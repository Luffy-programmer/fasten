package eu.fasten.analyzer.vulnerabilityplugin.utils;

import java.util.ArrayList;
import java.util.List;

public class Vulnerability {

    protected static class Cpe23Uri {
        private String vendor;
        private String product;
        private String version;

        public Cpe23Uri(String vendor, String product, String version) {
            this.vendor = vendor;
            this.product = product;
            this.version = version;
        }

        public String getVendor() {
            return vendor;
        }

        public void setVendor(String vendor) {
            this.vendor = vendor;
        }

        public String getProduct() {
            return product;
        }

        public void setProduct(String product) {
            this.product = product;
        }

        public String getVersion() {
            return version;
        }

        public void setVersion(String version) {
            this.version = version;
        }
    }

    private String id;

    private List<Cpe23Uri> cpe23Uris;
    private Double scoreCVSS2;
    private Double scoreCVSS3;

    private String publishedDate;
    private String lastModifiedDate;

    private String description;
    private List<String> references;
    private List<String> vulnerable_files;

    public Vulnerability(String id) {
        this.id = id;
        this.cpe23Uris = new ArrayList<Cpe23Uri>();
        this.references = new ArrayList<String>();
        this.vulnerable_files = new ArrayList<String>();
    }

    public List<Cpe23Uri> getCpe23Uris() {
        return cpe23Uris;
    }

    public void addCpeUri(Cpe23Uri cpe) {
        this.cpe23Uris.add(cpe);
    }

    public Double getScoreCVSS2() {
        return scoreCVSS2;
    }

    public void setScoreCVSS2(Double scoreCVSS2) {
        this.scoreCVSS2 = scoreCVSS2;
    }

    public Double getScoreCVSS3() {
        return scoreCVSS3;
    }

    public void setScoreCVSS3(Double scoreCVSS3) {
        this.scoreCVSS3 = scoreCVSS3;
    }

    public String getPublishedDate() {
        return publishedDate;
    }

    public void setPublishedDate(String publishedDate) {
        this.publishedDate = publishedDate;
    }

    public String getLastModifiedDate() {
        return lastModifiedDate;
    }

    public void setLastModifiedDate(String lastModifiedDate) {
        this.lastModifiedDate = lastModifiedDate;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public List<String> getReferences() {
        return this.references;
    }

    public void addReference(String url) {
        this.references.add(url);
    }

    public List<String> getVulnerable_files() {
        return vulnerable_files;
    }

    public void addVulnerableFile(String file) {
        this.vulnerable_files.add(file);
    }

    @Override
    public String toString() {
        return "Vulnerability{" +
                "id='" + id + '\'' +
                ", cpe23Uris=" + cpe23Uris +
                ", scoreCVSS2=" + scoreCVSS2 +
                ", scoreCVSS3=" + scoreCVSS3 +
                ", publishedDate='" + publishedDate + '\'' +
                ", lastModifiedDate='" + lastModifiedDate + '\'' +
                ", description='" + description + '\'' +
                ", references=" + references +
                ", vulnerable_files=" + vulnerable_files +
                '}';
    }
}


